<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jeu Pygame</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pygame.js/0.1.0/pygame.min.js"></script>
</head>
<body style="background-color: #F5DEB3;">
    <canvas id="gameCanvas" width="800" height="600"></canvas>
    <script>
        // Charger les images depuis les URLs
        function loadImage(url) {
            return new Promise((resolve, reject) => {
                const img = new Image();
                img.onload = () => resolve(img);
                img.onerror = reject;
                img.src = url;
            });
        }

        async function main() {
            const canvas = document.getElementById('gameCanvas');
            const ctx = canvas.getContext('2d');

            const playerImage = await loadImage("https://3ba8d8ca06.cbaul-cdnwnd.com/ad31ff7aa5568419f0bcf71e9af28d64/200000013-dc858dc859/700/drapeau%20Danazie%20mini.webp?ph=3ba8d8ca06");
            const enemyImage = await loadImage("https://3ba8d8ca06.cbaul-cdnwnd.com/ad31ff7aa5568419f0bcf71e9af28d64/200000355-b2009b200a/IMG_0749.webp?ph=3ba8d8ca06");

            const player = { x: canvas.width / 2, y: canvas.height / 2, speed: 5 };
            const enemy = { x: 0, y: 0, speed: 2 };

            let score = 0;
            let highScore = 0;
            let gameOver = false;

            const walls = [
                { x: 100, y: 100, width: 200, height: 20 },
                { x: 400, y: 300, width: 20, height: 200 },
                { x: 600, y: 150, width: 150, height: 20 }
            ];

            function draw() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.drawImage(playerImage, player.x, player.y, 50, 50);
                ctx.drawImage(enemyImage, enemy.x, enemy.y, 50, 50);
                ctx.fillStyle = 'white';
                ctx.font = '24px Arial';
                ctx.fillText(`Score: ${score}`, 10, 30);

                walls.forEach(wall => {
                    ctx.fillStyle = 'grey';
                    ctx.fillRect(wall.x, wall.y, wall.width, wall.height);
                });

                if (gameOver) {
                    ctx.fillText(`Meilleur Score: ${highScore}`, canvas.width / 2 - 100, canvas.height / 2);
                    ctx.fillText('Appuyez sur Entr√©e pour rejouer', canvas.width / 2 - 150, canvas.height / 2 + 50);
                }
            }

            function update() {
                if (!gameOver) {
                    if (keys['ArrowLeft']) player.x -= player.speed;
                    if (keys['ArrowRight']) player.x += player.speed;
                    if (keys['ArrowUp']) player.y -= player.speed;
                    if (keys['ArrowDown']) player.y += player.speed;

                    if (enemy.x < player.x) enemy.x += enemy.speed;
                    else if (enemy.x > player.x) enemy.x -= enemy.speed;

                    if (enemy.y < player.y) enemy.y += enemy.speed;
                    else if (enemy.y > player.y) enemy.y -= enemy.speed;

                    enemy.speed += 0.01;

                    if (Math.abs(player.x - enemy.x) < 50 && Math.abs(player.y - enemy.y) < 50) {
                        gameOver = true;
                        if (score > highScore) highScore = score;
                    }

                    walls.forEach(wall => {
                        if (player.x < wall.x + wall.width &&
                            player.x + 50 > wall.x &&
                            player.y < wall.y + wall.height &&
                            player.y + 50 > wall.y) {
                            gameOver = true;
                        }
                    });

                    score++;
                }
            }

            function loop() {
                update();
                draw();
                requestAnimationFrame(loop);
            }

            const keys = {};
            window.addEventListener('keydown', (e) => {
                keys[e.key] = true;
                if (e.key === 'Enter' && gameOver) {
                    gameOver = false;
                    score = 0;
                    player.x = canvas.width / 2;
                    player.y = canvas.height / 2;
                    enemy.x = Math.random() < 0.5 ? 0 : canvas.width - 50;
                    enemy.y = Math.random() < 0.5 ? 0 : canvas.height - 50;
                    enemy.speed = 2;
                }
            });
            window.addEventListener('keyup', (e) => {
                keys[e.key] = false;
            });

            enemy.x = Math.random() < 0.5 ? 0 : canvas.width - 50;
            enemy.y = Math.random() < 0.5 ? 0 : canvas.height - 50;

            loop();
        }

        main();
    </script>
</body>
</html>
